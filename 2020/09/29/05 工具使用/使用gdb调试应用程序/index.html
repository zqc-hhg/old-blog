<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Max&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            05 工具使用/使用gdb调试应用程序
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h2 id="一、gdb基本使用"><a href="#一、gdb基本使用" class="headerlink" title="一、gdb基本使用"></a>一、gdb基本使用</h2><p> GDB是一个由GNU开源组织发布的、UNIX/LINUX操作系统下的、基于命令行的、功能强大的程序调试工具。 对于一名Linux下工作的c++程序员，gdb是必不可少的工具；</p>
<h3 id="1-启动gdb"><a href="#1-启动gdb" class="headerlink" title="1. 启动gdb"></a>1. 启动gdb</h3><p> 对于C/C++程序，编译的时候需要加上 <code>-g</code> 参数生成调试信息。如:<code>gcc -g hello.c -o hello</code></p>
<ul>
<li><p>调试可执行程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$gdb 程序名称</span><br><span class="line">$gdb .&#x2F;hello</span><br></pre></td></tr></table></figure>
</li>
<li><p>调试服务程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$gdb 程序名称 进程pid</span><br><span class="line">$gdb hello  5678</span><br></pre></td></tr></table></figure>
</li>
<li><p>调试core文件(程序崩溃后生成的core dump 文件)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$gdb 程序名称 core文件名称</span><br><span class="line">$gdb hello  core.0609</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-gdb交互式命令"><a href="#2-gdb交互式命令" class="headerlink" title="2. gdb交互式命令"></a>2. gdb交互式命令</h3><p> 启动gdb后，进入到交互模式，通过以下命令完成对程序的调试；高频使用的命令一般都会有缩写，熟练使用这些缩写命令能提高调试的效率；</p>
<h4 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h4><ul>
<li><code>run：缩写为 r</code>，运行程序，当遇到断点后停止，程序会在断点处停止运行，等待用户输入下一步的命令，_类似于vs中的 F5_。</li>
<li><code>continue: 缩写为 c</code>，继续执行，到下一个断点(没有断点就运行到程序结束)。</li>
<li><code>step： 缩写为 s</code>，单步调试如果遇到函数则进入函数；与命令<code>n</code>不同，n是不尽然调用的函数的，_step 相当于vs的 F11_。</li>
<li><code>next：缩写为 n</code>，单步跟踪程序，当遇到调用函数时不进入函数；此命令与step的主要区别是，step 遇到用户自定义的函数，进步入到函数中运行，而 next 则是直接调用函数，不会进入到函数内，_next 相当于vs的 F10_。</li>
<li><code>until</code>： 当进入到循环中时，使用until命令可以使程序直接运行到退出循环体。</li>
<li><code>until+行号</code>：运行至指定行，不仅仅用来跳出循环。</li>
<li><code>finish</code>： 运行程序，知道当前函数返回，并打印函数返回时的堆栈地址和返回值及参数值等信息。</li>
<li><code>call 函数(参数)</code> ： 调用程序中的函数，并传递“参数”，如: <code>call add(3,2)</code></li>
<li><code>quit: 缩写为q</code>，退出gdb。</li>
</ul>
<h4 id="设置断点"><a href="#设置断点" class="headerlink" title="设置断点"></a>设置断点</h4><p>gdb使用<code>break(缩写为 b)</code> 来设置断点，具体使用如下：</p>
<ul>
<li><code>break n</code> (简写 b n)，在第 n 行处设置断点(可以写上代码路径和文件名称，如<code>b ./test.cpp:10</code>)</li>
<li><code>b fn1 if a&gt;b</code> ，设置条件断点。</li>
<li><code>b func</code> ，在函数func()入口处设置断点。</li>
<li><code>info b (info breakpoints)</code> 显示当前程序的断点设置情况和断点的断点号等信息。</li>
<li><code>disable 断点号n</code>， 禁用第n个断点。</li>
<li><code>enable 断点号n</code>，启用第n个断点。</li>
<li><code>delete 断点号n</code>，删除第n个断点。</li>
<li><code>delete breakpoints</code>，清除所有断点。</li>
</ul>
<h4 id="查看源代码"><a href="#查看源代码" class="headerlink" title="查看源代码"></a>查看源代码</h4><ul>
<li><code>list 简记为 l</code> : 列出程序的源代码，默认每次显示10行。</li>
<li><code>list 行号</code>：将显示当前文件以“行号”为中心的前后10行代码，如：list 12</li>
<li><code>list 函数名</code>：将显示“函数名”所在函数的源代码，如：list main</li>
<li><code>list</code> ：不带参数，将接着上一次 list 命令的，输出下边的内容。</li>
</ul>
<h4 id="打印表达式"><a href="#打印表达式" class="headerlink" title="打印表达式"></a>打印表达式</h4><ul>
<li><code>print 表达式</code>：简记为 p ，其中“表达式”可以是任何当前正在被测试程序的有效表达式，比如当前正在调试C语言的程序，那么“表达式”可以是任何C语言的有效表达式，包括数字，变量甚至是函数调用。</li>
<li><code>print a</code>：将显示整数 a 的值</li>
<li><code>print ++a</code>：将把 a 中的值加1,并显示出来</li>
<li><code>print name</code>：将显示字符串 name 的值</li>
<li><code>print gdb_test(22)</code>：将以整数22作为参数调用 gdb_test() 函数</li>
<li><code>print gdb_test(a)</code>：将以变量 a 作为参数调用 gdb_test() 函数</li>
<li><code>display 表达式</code>：在单步运行时将非常有用，使用display命令设置一个表达式后，它将在每次单步进行指令后，紧接着输出被设置的表达式及值。如： <code>display a</code></li>
<li><code>watch 表达式</code>：设置一个监视点，一旦被监视的“表达式”的值改变，gdb将强行终止正在被调试的程序。如： <code>watch a</code></li>
<li><code>whatis</code> ：查询变量或函数</li>
<li><code>info function</code>： 查询函数</li>
<li><code>扩展info locals</code>： 显示当前堆栈页的所有变量</li>
</ul>
<h4 id="查询查询运行信息"><a href="#查询查询运行信息" class="headerlink" title="查询查询运行信息"></a>查询查询运行信息</h4><ul>
<li><code>where/bt</code> ：当前运行的堆栈列表；</li>
<li><code>bt backtrace</code> 显示当前调用堆栈</li>
<li><code>up/down</code> 改变堆栈显示的深度</li>
<li><code>set args</code> 参数:指定运行时的参数</li>
<li><code>show args</code>：查看设置好的参数</li>
<li><code>info program</code>： 来查看程序的是否在运行，进程号，被暂停的原因。</li>
</ul>
<h4 id="分割窗口"><a href="#分割窗口" class="headerlink" title="分割窗口"></a>分割窗口</h4><ul>
<li><p><code>layout</code>：用于分割窗口，可以一边查看代码，一边测试：</p>
</li>
<li><p><code>layout src</code>：显示源代码窗口</p>
</li>
<li><p><code>layout asm</code>：显示反汇编窗口</p>
</li>
<li><p><code>layout regs</code>：显示源代码/反汇编和CPU寄存器窗口</p>
</li>
<li><p><code>layout split</code>：显示源代码和反汇编窗口</p>
</li>
<li><p><code>Ctrl + L</code>：刷新窗口</p>
</li>
</ul>

    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 <a class="flink" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>-<a class="flink" href="https://github.com/sanjinhub/hexo-theme-geek" target="_blank" rel="noopener">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="SPu2VRL8GBwy0tz4XPGRVVM8-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="wmFJLexGHhIBOmhlio1SFhCt">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>